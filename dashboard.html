<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Dashboard profissional com design inovador e recursos inteligentes">
  <title>Zyx | Dashboard Profissional</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --bg: #111217;
      --glass: rgba(255,255,255,0.07);
      --glass-border: rgba(255,255,255,0.14);
      --primary: #5f6fff;
      --primary-hover: #4555d6;
      --text: #f4f6fa;
      --text-light: #d8dbed;
      --muted: #9195a1;
      --success: #26d68a;
      --warning: #ffd600;
      --danger: #ff4f5a;
      --radius: 14px;
      --shadow: 0 8px 32px rgba(44, 62, 80, 0.25);
      --footer-bg: rgba(10, 10, 13, 0.85);
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }
    header {
      padding: 22px 48px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(18,19,25,0.95);
      border-bottom: 1px solid var(--glass-border);
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(14px);
      animation: fadeInDown 1s;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 16px;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      letter-spacing: 2px;
      text-shadow: 0 2px 8px rgba(44,62,80,0.18);
    }
    .user-menu {
      display: flex;
      align-items: center;
      gap: 28px;
    }
    .user-avatar {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary) 55%, #fff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.4rem;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 2px 14px rgba(44,62,80,0.32);
      transition: transform 0.25s;
      background-size: cover;
      background-position: center;
    }
    .user-avatar:hover { transform: scale(1.07) rotate(-2deg);}
    .container {
      display: flex;
      flex: 1;
      min-height: 0;
    }
    .sidebar {
      width: 290px;
      padding: 36px 18px;
      border-right: 1px solid var(--glass-border);
      background: var(--glass);
      display: flex;
      flex-direction: column;
      gap: 16px;
      backdrop-filter: blur(7px);
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--primary) transparent;
      animation: fadeInLeft 1.1s;
    }
    .sidebar::-webkit-scrollbar { width: 6px; }
    .sidebar::-webkit-scrollbar-thumb { background:var(--primary); border-radius:3px; }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 13px;
      padding: 14px 18px;
      border-radius: var(--radius);
      color: var(--text-light);
      text-decoration: none;
      font-size: 1.05rem;
      font-weight: 500;
      letter-spacing: 1px;
      transition: all 0.24s;
      cursor: pointer;
    }
    .nav-item:hover, .nav-item.active {
      background: var(--primary);
      color: #fff;
      box-shadow: 0 2px 16px rgba(44,62,80,0.18);
      transform: scale(1.03);
    }
    .nav-item.active { font-weight: 700; }
    .nav-item i { font-size: 1.15rem; width: 28px; text-align: center; }
    .sidebar .nav-item:last-child { margin-bottom: 0;}
    .main-content {
      flex: 1;
      padding: 38px 34px 22px 34px;
      display: flex;
      flex-direction: column;
      gap: 36px;
      animation: fadeIn 1.2s;
    }
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 18px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }
    .dashboard-title {
      font-size: 2.1rem;
      font-weight: 700;
      letter-spacing: 2px;
      color: var(--primary);
      text-shadow: 0 1px 8px rgba(44,62,80,0.12);
      animation: fadeIn 1.6s;
    }
    .glass-card {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 28px 26px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(22px);
      transition: transform 0.23s, box-shadow 0.23s;
      will-change: transform, box-shadow;
      animation: fadeInUp 1.2s;
    }
    .glass-card:hover {
      transform: translateY(-6px) scale(1.01);
      box-shadow: 0 16px 44px rgba(44,62,80,0.28);
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 18px;
    }
    .card-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--primary);
    }
    .card-actions { display: flex; gap: 12px; }
    .card-action {
      background: transparent;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 1.12rem;
      transition: color 0.23s, transform 0.23s;
    }
    .card-action:hover { color: var(--primary); transform: scale(1.1);}
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 22px;
      margin-bottom: 30px;
    }
    .stat-card {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: linear-gradient(135deg, var(--glass) 70%, var(--primary) 110%);
      border-radius: var(--radius);
      box-shadow: 0 4px 24px rgba(44,62,80,0.11);
      transition: box-shadow 0.22s;
    }
    .stat-card:hover { box-shadow: 0 12px 32px rgba(44,62,80,0.23);}
    .stat-value { font-size: 2.15rem; font-weight: 800; color: var(--primary);}
    .stat-label { color: var(--muted); font-size: 1.05rem;}
    .stat-change { font-size: .94rem; display:flex; align-items:center; gap:8px;}
    .positive { color: var(--success);}
    .negative { color: var(--danger);}
    button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: var(--radius);
      padding: 14px 24px;
      font-size: 1.04rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.23s;
      box-shadow: 0 2px 12px rgba(44,62,80,0.10);
    }
    button:hover { background: var(--primary-hover); transform: translateY(-3px) scale(1.03);}
    button.secondary {
      background: transparent;
      border: 1px solid var(--glass-border);
      color: var(--text);
      box-shadow: none;
    }
    button.secondary:hover { background: var(--glass); border-color: var(--primary);}
    button.danger { background: var(--danger);}
    button.danger:hover { background: #c0392b;}
    .btn-icon { font-size: 1.20rem;}
    .table-container {
      overflow-x: auto;
      max-height: 500px;
      scrollbar-width: thin;
      scrollbar-color: var(--primary) transparent;
    }
    .table-container::-webkit-scrollbar { width: 8px; height: 8px;}
    .table-container::-webkit-scrollbar-thumb { background:var(--primary); border-radius:4px;}
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 1.01rem;
      background: transparent;
      color: var(--text);
    }
    th, td {
      padding: 14px 18px;
      text-align: left;
      border-bottom: 1px solid var(--glass-border);
    }
    th {
      font-weight: 700;
      color: var(--muted);
      font-size: .93rem;
      text-transform: uppercase;
      letter-spacing: .7px;
      position: sticky;
      top: 0;
      background: var(--bg);
      z-index: 1;
    }
    tr:hover td { background: var(--glass);}
    .status {
      display: inline-block;
      padding: 6px 14px;
      border-radius: 22px;
      font-size: .97rem;
      font-weight: 600;
      letter-spacing: .5px;
      border: none;
    }
    .status-active { background:rgba(46,204,113,0.13); color:var(--success);}
    .status-pending { background:rgba(243,156,18,0.13); color:var(--warning);}
    .status-inactive { background:rgba(231,76,60,0.13); color:var(--danger);}
    .modal {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background:rgba(20,22,30,0.82);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:1000;
      opacity:0;
      pointer-events:none;
      transition: opacity 0.29s;
      backdrop-filter:blur(9px);
    }
    .modal.active { opacity:1; pointer-events:all;}
    .modal-content {
      background: var(--bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 36px 32px;
      width: 100%;
      max-width: 520px;
      box-shadow: var(--shadow);
      transform:translateY(22px);
      transition: transform 0.29s;
      animation: fadeInUp 0.9s;
    }
    .modal.active .modal-content { transform:translateY(0);}
    .modal-header {
      display:flex; justify-content:space-between; align-items:center; margin-bottom:22px;
    }
    .modal-title { font-size:1.31rem; font-weight:700; color:var(--primary);}
    .modal-close {
      background:none; border:none; color:var(--muted); font-size:1.55rem; cursor:pointer; transition: color .24s;
    }
    .modal-close:hover { color: var(--text);}
    .form-group { margin-bottom:22px;}
    label { display:block; margin-bottom:9px; font-size:1.05rem; color:var(--text-light);}
    input, select, textarea {
      width: 100%;
      padding: 14px 18px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 1.05rem;
      transition: border-color 0.24s, background 0.23s;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(44,62,80,0.10);
    }
    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 18px;
      margin-top: 36px;
    }
    .search-bar {
      margin-bottom: 18px;
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      max-width: 420px;
    }
    .search-bar input {
      flex: 1;
      padding: 10px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--glass-border);
      font-size: 1rem;
      background: var(--glass);
      color: var(--text);
      transition: border-color 0.2s;
    }
    .search-bar input:focus {
      border-color: var(--primary);
      outline: none;
    }
    .edit-row input,
    .edit-row select {
      background: var(--glass);
      color: var(--text);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 6px 12px;
      font-size: 1rem;
      margin-bottom: 0;
    }
    .edit-actions {
      display: flex;
      gap: 8px;
    }
    .card-action.delete {
      color: var(--danger);
    }
    .card-action.delete:hover {
      color: #c0392b;
      transform: scale(1.1);
    }
    .toast {
      position: fixed;
      bottom: 38px;
      right: 38px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 18px 22px;
      display: flex;
      align-items: center;
      gap: 18px;
      box-shadow: var(--shadow);
      transform: translateY(38px);
      opacity: 0;
      transition: all .29s;
      z-index: 1001;
      backdrop-filter: blur(11px);
      font-size: 1.04rem;
    }
    .toast.show { transform: translateY(0); opacity: 1;}
    .toast-icon { font-size: 1.32rem;}
    .toast-success .toast-icon { color: var(--success);}
    .toast-error .toast-icon { color: var(--danger);}
    .toast-error .toast-title { color: var(--danger);}
    .toast-error { border-color: var(--danger);}
    .toast-content { flex: 1;}
    .toast-title { font-weight: 700; margin-bottom: 6px;}
    .toast-message { font-size: 1.01rem; color: var(--text-light);}
    .toast-close {
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 1.15rem;
      transition: color .23s;
    }
    .toast-close:hover { color: var(--danger);}
    @media (max-width:1024px){
      .sidebar{width:210px; padding:22px 9px;}
      .main-content{padding:24px;}
      .dashboard-title{font-size:1.55rem;}
    }
    @media (max-width:768px){
      .sidebar{position:fixed;top:0;left:-290px;bottom:0;width:290px;z-index:100;background:var(--bg);transition:transform .24s;}
      .sidebar.active{transform:translateX(290px);}
      .main-content{padding:18px;}
      .stats-grid{grid-template-columns:1fr 1fr;}
    }
    @media (max-width:480px){
      header{padding:13px 12px;}
      .dashboard-title{font-size:1.21rem;}
      .stats-grid{grid-template-columns:1fr;}
      .form-actions{flex-direction:column;}
      button{width:100%;}
      .modal-content{padding:22px 12px;}
    }
    @keyframes fadeIn {from{opacity:0;} to{opacity:1;}}
    @keyframes fadeInUp {from{opacity:0; transform:translateY(40px);} to{opacity:1; transform:translateY(0);}}
    @keyframes fadeInDown {from{opacity:0; transform:translateY(-40px);} to{opacity:1; transform:translateY(0);}}
    @keyframes fadeInLeft {from{opacity:0; transform:translateX(-40px);} to{opacity:1; transform:translateX(0);}}
    /* Loader animado */
    .skeleton-loader {
      background: linear-gradient(90deg, #171820 22%, #232440 50%, #171820 78%);
      background-size: 200% 100%;
      border-radius: var(--radius);
      animation: loading 1.5s infinite;
      min-height: 18px;
    }
    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    /* Footer elegante */
    footer {
      width: 100%;
      background: var(--footer-bg);
      color: var(--text-light);
      text-align: center;
      padding: 18px 0 10px 0;
      font-size: 1rem;
      font-weight: 500;
      border-top: 1px solid var(--glass-border);
      letter-spacing: 1px;
      box-shadow: 0 -2px 12px rgba(44,62,80,0.10);
      margin-top: auto;
      animation: fadeInUp 1.3s;
    }
    /* Acessibilidade */
    .nav-item:focus, button:focus, .card-action:focus, .modal-close:focus, .toast-close:focus {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
      background: rgba(44,62,80,0.08);
    }
  </style>
</head>
<body>
  <header>
    <div class="logo" aria-label="Logo Zyx">
      <i class="fas fa-brain" aria-hidden="true"></i>
      <span>Zyx</span>
    </div>
    <div class="user-menu">
      <button class="secondary" id="notificationsBtn" aria-label="Notificações">
        <i class="fas fa-bell"></i>
      </button>
      <div class="user-avatar" id="userAvatar" tabindex="0" aria-label="Perfil do usuário">
        <i class="fas fa-user"></i>
      </div>
    </div>
  </header>
  <div class="container">
    <aside class="sidebar" aria-label="Menu lateral">
      <a href="#" class="nav-item active" tabindex="0">
        <i class="fas fa-home"></i>
        <span>Dashboard</span>
      </a>
      <a href="#" class="nav-item" onclick="mostrarDados()" tabindex="0">
        <i class="fas fa-database"></i>
        <span>Dados</span>
      </a>
      <div id="dados" style="display: none; padding: 18px; color: #fff;">
        <h3>📊 Informações do Sistema</h3>
        <ul style="list-style: none; padding-left: 0;">
          <li>👥 Usuários ativos: <strong>2</strong></li>
          <li>⏱ Último login: <strong>agora</strong></li>
          <li>🌐 Status do servidor: <span style="color: #26d68a;">Online</span></li>
          <li>🧠 Processos ativos: <strong>Firebase Auth</strong></li>
        </ul>
      </div>
      <a href="#" class="nav-item" tabindex="0">
        <i class="fas fa-cog"></i>
        <span>Configurações</span>
      </a>
      <a href="#" class="nav-item" tabindex="0">
        <i class="fas fa-users"></i>
        <span>Usuários</span>
      </a>
      <a href="#" class="nav-item" tabindex="0">
        <i class="fas fa-file-alt"></i>
        <span>Relatórios</span>
      </a>
      <div style="flex:1;"></div>
      <button class="secondary" id="logoutBtn" aria-label="Sair">
        <i class="fas fa-sign-out-alt"></i>
        <span>Sair</span>
      </button>
    </aside>
    <main class="main-content" aria-label="Conteúdo principal">
      <div class="dashboard-header">
        <h1 class="dashboard-title">Bem-vindo de volta!</h1>
        <button id="newProjectBtn" aria-label="Criar novo projeto">
          <i class="fas fa-plus"></i>
          <span>Novo Projeto</span>
        </button>
      </div>
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Buscar projeto...">
        <i class="fas fa-search" style="color: var(--muted);"></i>
      </div>
      <div class="stats-grid">
        <div class="glass-card stat-card">
          <div class="stat-value">1,248</div>
          <div class="stat-label">Visitas Hoje</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>12% em relação a ontem</span>
          </div>
        </div>
        <div class="glass-card stat-card">
          <div class="stat-value">100%</div>
          <div class="stat-label">Taxa de Conversão</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>5% em relação ao mês passado</span>
          </div>
        </div>
        <div class="glass-card stat-card">
          <div class="stat-value">R$ 50.000</div>
          <div class="stat-label">Receita Mensal</div>
          <div class="stat-change negative">
            <i class="fas fa-arrow-down"></i>
            <span>3% em relação ao mês passado</span>
          </div>
        </div>
        <div class="glass-card stat-card">
          <div class="stat-value">356</div>
          <div class="stat-label">Novos Clientes</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>8% em relação ao mês passado</span>
          </div>
        </div>
      </div>
      <div class="glass-card">
        <div class="card-header">
          <h2 class="card-title">Projetos Recentes</h2>
          <div class="card-actions">
            <button class="card-action" id="refreshProjects" aria-label="Atualizar projetos">
              <i class="fas fa-sync-alt"></i>
            </button>
            <button class="card-action" aria-label="Mais ações">
              <i class="fas fa-ellipsis-v"></i>
            </button>
          </div>
        </div>
        <div class="table-container" aria-label="Tabela de projetos">
          <table id="projectsTable">
            <thead>
              <tr>
                <th>Nome do Projeto</th>
                <th>Responsável</th>
                <th>Status</th>
                <th>Progresso</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="projectsBody">
              <!-- Projetos serão carregados dinamicamente -->
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
  <!-- Modal de Novo Projeto -->
  <div class="modal" id="newProjectModal" aria-modal="true" role="dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Criar Novo Projeto</h3>
        <button class="modal-close" id="closeModalBtn" aria-label="Fechar">&times;</button>
      </div>
      <form id="projectForm">
        <div class="form-group">
          <label for="projectName">Nome do Projeto</label>
          <input type="text" id="projectName" placeholder="Digite o nome do projeto" required autocomplete="off">
        </div>
        <div class="form-group">
          <label for="projectDescription">Descrição</label>
          <textarea id="projectDescription" rows="3" placeholder="Descreva o projeto"></textarea>
        </div>
        <div class="form-group">
          <label for="projectOwner">Responsável</label>
          <select id="projectOwner" required>
            <option value="">Selecione um responsável</option>
          </select>
        </div>
        <div class="form-group">
          <label for="projectDeadline">Prazo</label>
          <input type="date" id="projectDeadline" required>
        </div>
        <div class="form-actions">
          <button type="button" class="secondary" id="cancelProjectBtn">Cancelar</button>
          <button type="submit">Criar Projeto</button>
        </div>
      </form>
    </div>
  </div>
  <!-- Toast Notification -->
  <div class="toast toast-success" id="successToast" role="status" aria-live="polite" style="display:none;">
    <i class="fas fa-check-circle toast-icon"></i>
    <div class="toast-content">
      <div class="toast-title">Sucesso!</div>
      <div class="toast-message">Projeto criado com sucesso.</div>
    </div>
    <button class="toast-close" aria-label="Fechar">&times;</button>
  </div>
  <div class="toast toast-error" id="errorToast" role="status" aria-live="polite" style="display:none;">
    <i class="fas fa-exclamation-circle toast-icon"></i>
    <div class="toast-content">
      <div class="toast-title">Erro!</div>
      <div class="toast-message" id="errorToastMsg"></div>
    </div>
    <button class="toast-close" aria-label="Fechar">&times;</button>
  </div>
  <!-- Firebase Auth -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>
    // Responsáveis dinâmicos
    const responsaveis = [
      {id: "1", nome: "João Silva"},
      {id: "2", nome: "Maria Souza"},
      {id: "3", nome: "Carlos Oliveira"},
      {id: "4", nome: "Ana Santos"}
    ];

    // Firebase config & init
    const firebaseConfig = {
      apiKey: "AIzaSyAEtOJtXMIclBzLNNsEXJKqF4Rsqg_AAHs",
      authDomain: "arthur-dba38.firebaseapp.com",
      projectId: "arthur-dba38",
      storageBucket: "arthur-dba38.firebasestorage.app",
      messagingSenderId: "226852614993",
      appId: "1:226852614993:web:5f60769150d33a50e69970",
      measurementId: "G-WSNY5JJS7Q"
    };
    firebase.initializeApp(firebaseConfig);

    // Preenche select de responsáveis
    function fillResponsaveisSelect(selectId) {
      const select = document.getElementById(selectId);
      select.innerHTML = '<option value="">Selecione um responsável</option>';
      responsaveis.forEach(r => {
        const opt = document.createElement('option');
        opt.value = r.id;
        opt.innerText = r.nome;
        select.appendChild(opt);
      });
    }

    // Projetos
    let projects = JSON.parse(localStorage.getItem('projects')) || [
      { name: "Dashboard de Analytics", responsible: "João Silva", status: "active", progress: 75 },
      { name: "Integração de API", responsible: "Maria Souza", status: "pending", progress: 30 },
      { name: "Atualização de Segurança", responsible: "Carlos Oliveira", status: "active", progress: 90 },
      { name: "Migração de Banco de Dados", responsible: "Ana Santos", status: "inactive", progress: 10 }
    ];

    // Render projetos com busca e edição
    let searchTerm = "";
    let editIndex = null;

    function renderProjects() {
      const projectsBody = document.getElementById('projectsBody');
      projectsBody.innerHTML = '';
      projects
        .filter(project => project.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
          project.responsible.toLowerCase().includes(searchTerm.toLowerCase()))
        .forEach((project, idx) => {
          if (editIndex === idx) {
            // Row de edição inline
            const row = document.createElement('tr');
            row.classList.add('edit-row');
            row.innerHTML = `
              <td><input type="text" id="editName" value="${project.name}" /></td>
              <td>
                <select id="editResponsible">
                  ${responsaveis.map(r => `<option value="${r.nome}" ${r.nome===project.responsible?'selected':''}>${r.nome}</option>`).join('')}
                </select>
              </td>
              <td>
                <select id="editStatus">
                  <option value="active" ${project.status==="active"?"selected":""}>Ativo</option>
                  <option value="pending" ${project.status==="pending"?"selected":""}>Pendente</option>
                  <option value="inactive" ${project.status==="inactive"?"selected":""}>Inativo</option>
                </select>
              </td>
              <td><input type="number" id="editProgress" min="0" max="100" value="${project.progress}" style="width:60px" /></td>
              <td class="edit-actions">
                <button class="card-action" title="Salvar" onclick="saveEdit(${idx})"><i class="fas fa-check"></i></button>
                <button class="card-action" title="Cancelar" onclick="cancelEdit()"><i class="fas fa-times"></i></button>
              </td>
            `;
            projectsBody.appendChild(row);
          } else {
            // Row normal
            let statusClass, statusText;
            switch(project.status) {
              case 'active': statusClass = 'status-active'; statusText = 'Ativo'; break;
              case 'pending': statusClass = 'status-pending'; statusText = 'Pendente'; break;
              case 'inactive': statusClass = 'status-inactive'; statusText = 'Inativo'; break;
            }
            let progressColor;
            if (project.progress < 30) { progressColor = 'var(--danger)'; }
            else if (project.progress < 70) { progressColor = 'var(--warning)'; }
            else { progressColor = 'var(--success)'; }
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${project.name}</td>
              <td>${project.responsible}</td>
              <td><span class="status ${statusClass}">${statusText}</span></td>
              <td>
                <div style="background: var(--glass); height: 8px; border-radius: 4px;">
                  <div style="width: ${project.progress}%; height: 100%; background: ${progressColor}; border-radius: 4px;"></div>
                </div>
              </td>
              <td>
                <button class="card-action" title="Editar Projeto" onclick="editRow(${idx})"><i class="fas fa-edit"></i></button>
                <button class="card-action delete" title="Excluir Projeto" onclick="deleteProject(${idx})"><i class="fas fa-trash"></i></button>
              </td>
            `;
            projectsBody.appendChild(row);
          }
        });
    }

    window.editRow = function(idx) {
      editIndex = idx;
      renderProjects();
    }
    window.cancelEdit = function() {
      editIndex = null;
      renderProjects();
    }
    window.saveEdit = function(idx) {
      const newName = document.getElementById('editName').value.trim();
      const newResponsible = document.getElementById('editResponsible').value;
      const newStatus = document.getElementById('editStatus').value;
      let newProgress = parseInt(document.getElementById('editProgress').value);
      if (!newName || !newResponsible || isNaN(newProgress) || newProgress < 0 || newProgress > 100) {
        showErrorToast("Preencha todos os campos corretamente!");
        return;
      }
      projects[idx] = {
        ...projects[idx],
        name: newName,
        responsible: newResponsible,
        status: newStatus,
        progress: newProgress
      };
      localStorage.setItem('projects', JSON.stringify(projects));
      editIndex = null;
      renderProjects();
      showToast("Projeto atualizado com sucesso!");
    }

    window.deleteProject = function(idx) {
      if (confirm("Deseja realmente excluir este projeto?")) {
        projects.splice(idx, 1);
        localStorage.setItem('projects', JSON.stringify(projects));
        renderProjects();
        showToast("Projeto removido com sucesso!");
      }
    }

    // Busca de projetos
    document.getElementById('searchInput').addEventListener('input', function() {
      searchTerm = this.value;
      renderProjects();
    });

    // Mostra dados
    window.mostrarDados = function() {
      const bloco = document.getElementById("dados");
      bloco.style.display = bloco.style.display === "none" ? "block" : "none";
    }

    // Autenticação
    firebase.auth().onAuthStateChanged((user) => {
      if (!user) window.location.href = "index.html";
      else renderProjects();
    });

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", () => {
      firebase.auth().signOut().then(() => window.location.href = "index.html");
    });

    // Modal de Novo Projeto
    fillResponsaveisSelect('projectOwner');
    const newProjectBtn = document.getElementById('newProjectBtn');
    const newProjectModal = document.getElementById('newProjectModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const cancelProjectBtn = document.getElementById('cancelProjectBtn');
    const projectForm = document.getElementById('projectForm');
    const successToast = document.getElementById('successToast');
    const errorToast = document.getElementById('errorToast');
    const errorToastMsg = document.getElementById('errorToastMsg');

    newProjectBtn.addEventListener('click', () => newProjectModal.classList.add('active'));
    closeModalBtn.addEventListener('click', () => newProjectModal.classList.remove('active'));
    cancelProjectBtn.addEventListener('click', () => newProjectModal.classList.remove('active'));

    // Toasts
    function showToast(msg="Projeto criado com sucesso.") {
      successToast.querySelector('.toast-message').innerText = msg;
      successToast.style.display = "";
      successToast.classList.add('show');
      setTimeout(() => {
        successToast.classList.remove('show');
        successToast.style.display = "none";
      }, 4200);
    }
    successToast.querySelector('.toast-close').addEventListener('click', () => {
      successToast.classList.remove('show');
      successToast.style.display = "none";
    });

    function showErrorToast(msg="Erro!") {
      errorToastMsg.innerText = msg;
      errorToast.style.display = "";
      errorToast.classList.add('show');
      setTimeout(() => {
        errorToast.classList.remove('show');
        errorToast.style.display = "none";
      }, 4200);
    }
    errorToast.querySelector('.toast-close').addEventListener('click', () => {
      errorToast.classList.remove('show');
      errorToast.style.display = "none";
    });

    // Novo projeto
    projectForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const projectName = document.getElementById('projectName').value.trim();
      const projectOwnerSelect = document.getElementById('projectOwner');
      const responsibleId = projectOwnerSelect.value;
      const responsibleName = responsaveis.find(r => r.id === responsibleId)?.nome || "";
      const projectDeadline = document.getElementById('projectDeadline').value;
      if (!projectName) return showErrorToast("O nome do projeto é obrigatório.");
      if (!responsibleName) return showErrorToast("Selecione um responsável válido.");
      if (!projectDeadline) return showErrorToast("Informe o prazo do projeto.");

      projects.unshift({
        name: projectName,
        responsible: responsibleName,
        status: 'pending',
        progress: 0
      });
      localStorage.setItem('projects', JSON.stringify(projects));
      renderProjects();
      newProjectModal.classList.remove('active');
      showToast();
      projectForm.reset();
    });

    // Atualizar projetos
    document.getElementById('refreshProjects').addEventListener('click', () => renderProjects());

    // Sidebar responsiva
    const sidebar = document.querySelector('.sidebar');
    const userAvatar = document.getElementById('userAvatar');
    userAvatar.addEventListener('click', () => {
      if (window.innerWidth <= 768) sidebar.classList.toggle('active');
    });
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 768 && !sidebar.contains(e.target) && e.target !== userAvatar) {
        sidebar.classList.remove('active');
      }
    });

    // Inicialização
    renderProjects();
  </script>
  <footer>
    @tukarth - Todos os direitos reservados. &copy; 2025
  </footer>
</body>
</html>
